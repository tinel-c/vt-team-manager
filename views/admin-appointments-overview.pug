doctype html
//
  =========================================================
  * VT Team manager
  =========================================================
head
  meta(charset='utf-8')
  meta(name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no')
  meta(name='description' content='Manage your team with the all in one dashboard')
  meta(name='author' content='Constantin Bogza')
  meta(name='base-author' content='Creative Tim')

  link(href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC' crossorigin='anonymous')
  // Add the slick-theme.css if you want default styling
  link(rel='stylesheet' type='text/css' href='https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.css')
  link(rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.css')
  link(rel='stylesheet' href='https://use.fontawesome.com/releases/v5.15.3/css/all.css' integrity='sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk' crossorigin='anonymous')
  link(rel='stylesheet' href='./assets/css/calendar.css')
  link(rel='stylesheet' href='./assets/css/error-too-many-apps.css')
  script(src='./assets/js/selectorEmail.js')
  script(src='./assets/js/addZero.js')
  title Appointment overview
  // Favicon
  link(rel='icon' href='../assets/img/brand/favicon.ico' type='image/ico')
  // Fonts
  link(rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700')
  // Icons
  link(rel='stylesheet' href='../assets/vendor/nucleo/css/nucleo.css' type='text/css')
  link(rel='stylesheet' href='../assets/vendor/@fortawesome/fontawesome-free/css/all.min.css' type='text/css')
  // Argon CSS
  link(rel='stylesheet' href='../assets/css/argon.css?v=1.2.0' type='text/css')
  link(rel='stylesheet' href='../assets/css/search-box.css' type='text/css')
  link(rel='stylesheet' href='../assets/css/admin-add-user.css' type='text/css')
  link(rel='stylesheet' href='../assets/css/configure-mm-grids.css' type='text/css')
// Sidenav
nav#sidenav-main.sidenav.navbar.navbar-vertical.fixed-left.navbar-expand-xs.navbar-light.bg-white
  .scrollbar-inner
    // Brand
    .sidenav-header.align-items-center
      a.navbar-brand(href='/dashboard')
        img.navbar-brand-img(src='assets/img/brand/vt-team-manager.png' alt='...')
    .navbar-inner
      // Collapse
      #sidenav-collapse-main.collapse.navbar-collapse
        // Nav items
        ul.navbar-nav
          li.nav-item
            a.nav-link(href='/dashboard')
              i.ni.ni-tv-2.text-primary
              span.nav-link-text Dashboard
          li.nav-item
            a.nav-link(href='/ssm-su')
              i.ni.ni-support-16.text-orange
              span.nav-link-text SSM and SU
          li.nav-item
            a.nav-link(href='/medical-check')
              i.ni.ni-ambulance.text-primary
              span.nav-link-text Medical check
          li.nav-item
            a.nav-link(href='/programare-MM')
              i.ni.ni-ambulance2.text-primary
              span.nav-link-text Programare MM
          li.nav-item
            a.nav-link(href='/competency-management')
              i.ni.ni-bullet-list-67.text-default
              span.nav-link-text Competecy management
          li.nav-item
            a.nav-link(href='/team-leader-page')
              i.ni.team-leader-icon.text-primary
              span.nav-link-text Team leader's page
          li.nav-item
            a.nav-link(href='/admin-page')
              i.ni.admin-icon.text-primary
              span.nav-link-text Admin's page
        // Divider
        hr.my-3
        // Heading
        h6.navbar-heading.p-0.text-muted
          span.docs-normal Account management

        case userLoggedIn
          when true
            ul.navbar-nav
              li#profile.nav-item
                a.nav-link(href='/profile')
                  i.ni.ni-single-02.text-yellow
                  span.nav-link-text Profile
            break
          default
            ul.navbar-nav
              li#login.nav-item
                a.nav-link(href='/login')
                  i.ni.ni-key-25.text-info
                  span.nav-link-text Login
// Main content
.main-content
  // Header
  .header.bg-gradient-primary.py-7.py-lg-5.pt-lg-5
    .container
      .thisIsAnError #{messages.error}
      .header-body.text-center.mb-7
        .row.justify-content-center
          .col-xl-5.col-lg-6.col-md-8.px-5
    .separator.separator-bottom.separator-skew.zindex-100
      svg(x='0' y='0' viewbox='0 0 2560 100' preserveaspectratio='none' version='1.1' xmlns='http://www.w3.org/2000/svg')
  // Page content
  .container
    h1 Export an excel table with the appointments
    small Here you can export an excel table with all the appointments made between two days
    hr
    form(role='form' action="/export-appointments-table" method="post")
      div.add-new-appointment-day-wrapper
        div
          p select the starting date:
          select.selector-bg-color(name="appStart" class="date-and-time" placeholder="Select the weekday" id="dynamic_select" required='')
            each appointment in appointments
              - let startingHour = appointment.Starting_Hour.getUTCHours();
              - let startingMinutes = appointment.Starting_Hour.getUTCMinutes();
              - let endingHour = appointment.Ending_Hour.getUTCHours();
              - let endingMinutes = appointment.Ending_Hour.getUTCMinutes();
              - if (startingHour < 10) {startingHour = "0" + startingHour;}
              - if (startingMinutes < 10) {startingMinutes = "0" + startingMinutes;}
              - if (endingHour < 10) {endingHour = "0" + endingHour;}
              - if (endingMinutes < 10) {endingMinutes = "0" + endingMinutes;}
              option.u-text--info(value=appointment.Date name="deleteAppointment") #{appointment.Date.toLocaleString('en-us', {weekday:'long'})+", "+appointment.Date.getUTCDate()+" "+appointment.Date.toLocaleString('en', { month: 'short' })+" "+appointment.Date.getUTCFullYear() + ", " + startingHour + ":" + startingMinutes + "-" + endingHour + ":" + endingMinutes}
        div
          p select the ending date:
          select.selector-bg-color(name="appEnd" class="date-and-time" placeholder="Select the weekday" id="dynamic_select" required='')
            each appointment in appointments
              - let startingHour = appointment.Starting_Hour.getUTCHours();
              - let startingMinutes = appointment.Starting_Hour.getUTCMinutes();
              - let endingHour = appointment.Ending_Hour.getUTCHours();
              - let endingMinutes = appointment.Ending_Hour.getUTCMinutes();
              - if (startingHour < 10) {startingHour = "0" + startingHour;}
              - if (startingMinutes < 10) {startingMinutes = "0" + startingMinutes;}
              - if (endingHour < 10) {endingHour = "0" + endingHour;}
              - if (endingMinutes < 10) {endingMinutes = "0" + endingMinutes;}
              option.u-text--info(value=appointment.Date name="deleteAppointment") #{appointment.Date.toLocaleString('en-us', {weekday:'long'})+", "+appointment.Date.getUTCDate()+" "+appointment.Date.toLocaleString('en', { month: 'short' })+" "+appointment.Date.getUTCFullYear() + ", " + startingHour + ":" + startingMinutes + "-" + endingHour + ":" + endingMinutes}
        div  
          p 
          button#sign-in.btn.btn-primary.my-4.position-top(type='submit' value="Submit") Export Table
        div
    br
    br
// Core
script(src='../assets/vendor/jquery/dist/jquery.min.js')
script(src='../assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js')
script(src='../assets/vendor/js-cookie/js.cookie.js')
script(src='../assets/vendor/jquery.scrollbar/jquery.scrollbar.min.js')
script(src='../assets/vendor/jquery-scroll-lock/dist/jquery-scrollLock.min.js')
// Argon JS
script(src='../assets/js/argon.js?v=1.2.0')
// Add custom js
script(src='../assets/js/auth.js')
//script(src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js")

script(src='../assets/js/search-box.js')
script(src='https://code.jquery.com/jquery-3.6.0.min.js' integrity='sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=' crossorigin='anonymous')
script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js' integrity='sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM' crossorigin='anonymous')
script(type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js')
script(src='./assets/js/calendar.js')
script(src='./assets/js/selectorEmail.js')